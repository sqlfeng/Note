>## 2017年8月3日

## 联华

### axcq200

PKUWH_SCRK
```sql
SELECT UNIQUE xckb001,xckb002,xckb003,xckb004,xckb005,xckb006,xckb036,xmdk001,xckb009,pmaal004,xckc005,'',xckb010,ooag011,               xckb011,ooefl003,xckb012,imaal003,imaal004,xckb037,'',               xckb013,xckb014,xckb015,'',xckb016,'',xckb017,               xckb102,xckb102a,xckb102b,xckb102c,xckb102d,xckb102e,xckb102f,xckb102g,xckb102h,               xckb101,xckb101a,xckb101b,xckb101c,xckb101d,xckb101e,xckb101f,xckb101g,xckb101h, xmdk016,xmdk017,xmdl024,round(xmdl027*xmdk017,2),round(xmdl029*xmdk017,2),round(xmdl028*xmdk017,2),              xckb112,xckb112a,xckb112b,xckb112c,xckb112d,xckb112e,xckb112f,xckb112g,xckb112h,               xckb111,xckb111a,xckb111b,xckb111c,xckb111d,xckb111e,xckb111f,xckb111g,xckb111h,               xckb122,xckb122a,xckb122b,xckb122c,xckb122d,xckb122e,xckb122f,xckb122g,xckb122h,               xckb121,xckb121a,xckb121b,xckb121c,xckb121d,xckb121e,xckb121f,xckb121g,xckb121h   
FROM xckb_t LEFT JOIN pmaal_t ON pmaalent='88' AND pmaal001=xckb009 AND pmaal002='zh_CN'               LEFT JOIN ooag_t  ON ooagent ='88' AND ooag001 =xckb010               LEFT JOIN ooefl_t ON ooeflent='88' AND ooefl001=xckb011 AND ooefl002='zh_CN'               LEFT JOIN imaal_t ON imaalent='88' AND imaal001=xckb012 AND imaal002='zh_CN'               LEFT JOIN xmdk_t  ON xmdkent ='88' AND xmdkdocno=xckb005               LEFT JOIN xmdl_t  ON xmdlent ='88' AND xmdldocno=xckb005 AND xmdlseq=xckb006               LEFT JOIN xckc_t  ON xckcent = xckbent AND xckccomp = xckbcomp AND xckcld = xckbld                                AND xckc001 = xckb007 AND xckc002 = xckb008 AND xckc003 = xckb009 AND xckc004 = xckb012 AND xckc023 = xckb037  
WHERE xckbent =     88   AND xckbcomp='LH01'    AND xckbld  ='00'    AND xckb007 =   2017   AND xckb008 =      6   AND xckbcomp='LH01' and xckbld='00' and xckb007=2017 and xckb008=6

```
第一条结果
```sql
g_detail[1] = {xckb001 = "4", xckb002 = -1, xckb003 = "47394163", xckb004 = "LH01", xckb005 = "LH1-XM93-17050013", xckb006 = 3, xckb036 = 0, xmdk001 = 17/05/09, xckb009 = "CF0028", xckb009_desc = "昆山牧田", xckc005 = (null), xckc005_desc = (null), xckb010 = "K5171", xckb010_desc = "申海霞", xckb011 = "LH01", xckb011_desc = "联华塑胶", xckb012 = "CN400659", xckb012_desc = "内衬", xckb012_desc2 = "透明 15-17g 837826-5 PET0.2mm 高65mm 宽92mm 牧田", xckb037 = "02", xckb037_desc = (null), xckb013 = "PCS", xckb014 = 2000.000000, xckb015 = " ", xckb015_desc = (null), xckb016 = " ", xckb016_desc = (null), xckb017 = " ", xckb102 = 5982.900000, xckb102a = 5982.900000, xckb102b = 0.000000, xckb102c = 0.000000, xckb102d = 0.000000, xckb102e = 0.000000, xckb102f = 0.000000, xckb102g = 0.000000, xckb102h = 0.000000, xckb101 = 2.991450, xckb101a = 2.991450, xckb101b = 0.000000, xckb101c = 0.000000, xckb101d = 0.000000, xckb101e = 0.000000, xckb101f = 0.000000, xckb101g = 0.000000, xckb101h = 0.000000, xckbua123 = "USD", xckbua124 = 6.8956000000, xckbua125 = 0.594700, xckbua126 = 8201.630000, xckbua127 = 0.000000, xckbua128 = 8201.630000
```

```sql
g_detail[1] = {xckb001 = "4", xckb002 = -1, xckb003 = "47394163", xckb004 = "LH01", xckb005 = "LH1-XM93-17050013", xckb006 = 3, xckb036 = 0, xmdk001 = 17/05/09, xckb009 = "CF0028", xckb009_desc = "昆山牧田", xckc005 = (null), xckc005_desc = (null), xckb010 = "K5171", xckb010_desc = "申海霞", xckb011 = "LH01", xckb011_desc = "联华塑胶", xckb012 = "CN400659", xckb012_desc = "内衬", xckb012_desc2 = "透明 15-17g 837826-5 PET0.2mm 高65mm 宽92mm 牧田", xckb037 = "02", xckb037_desc = (null), xckb013 = "PCS", xckb014 = 2000.000000, xckb015 = " ", xckb015_desc = (null), xckb016 = " ", xckb016_desc = (null), xckb017 = " ", xckb102 = 5982.900000, xckb102a = 5982.900000, xckb102b = 0.000000, xckb102c = 0.000000, xckb102d = 0.000000, xckb102e = 0.000000, xckb102f = 0.000000, xckb102g = 0.000000, xckb102h = 0.000000, xckb101 = 2.991450, xckb101a = 2.991450, xckb101b = 0.000000, xckb101c = 0.000000, xckb101d = 0.000000, xckb101e = 0.000000, xckb101f = 0.000000, xckb101g = 0.000000, xckb101h = 0.000000, xckbua123 = "USD", xckbua124 = 6.8956000000, xckbua125 = 0.594700, xckbua126 = 8201.630000, xckbua127 = 0.000000, xckbua128 = 8201.630000}

g_detail[2] = {xckb001 = "4", xckb002 = -1, xckb003 = "47394163", xckb004 = "LH01", xckb005 = "LH1-XM93-17050009", xckb006 = 2, xckb036 = 0, xmdk001 = 17/05/08, xckb009 = "CF0028", xckb009_desc = "昆山牧田", xckc005 = (null), xckc005_desc = (null), xckb010 = "K5171", xckb010_desc = "申海霞", xckb011 = "LH01", xckb011_desc = "联华塑胶", xckb012 = "CN400659", xckb012_desc = "内衬", xckb012_desc2 = "透明 15-17g 837826-5 PET0.2mm 高65mm 宽92mm 牧田", xckb037 = "02", xckb037_desc = (null), xckb013 = "PCS", xckb014 = 2000.000000, xckb015 = " ", xckb015_desc = (null), xckb016 = " ", xckb016_desc = (null), xckb017 = " ", xckb102 = 5982.900000, xckb102a = 5982.900000, xckb102b = 0.000000, xckb102c = 0.000000, xckb102d = 0.000000, xckb102e = 0.000000, xckb102f = 0.000000, xckb102g = 0.000000, xckb102h = 0.000000, xckb101 = 2.991450, xckb101a = 2.991450, xckb101b = 0.000000, xckb101c = 0.000000, xckb101d = 0.000000, xckb101e = 0.000000, xckb101f = 0.000000, xckb101g = 0.000000, xckb101h = 0.000000, xckbua123 = "USD", xckbua124 = 6.8956000000, xckbua125 = 0.594700, xckbua126 = 8201.630000, xckbua127 = 0.000000, xckbua128 = 8201.630000}

g_detail[3] = {xckb001 = "4", xckb002 = -1, xckb003 = "47394181", xckb004 = "LH01", xckb005 = "LH1-XM93-17060004", xckb006 = 1, xckb036 = 0, xmdk001 = 17/06/02, xckb009 = "CF0028", xckb009_desc = "昆山牧田", xckc005 = (null), xckc005_desc = (null), xckb010 = "K5171", xckb010_desc = "申海霞", xckb011 = "LH01", xckb011_desc = "联华塑胶", xckb012 = "CN400659", xckb012_desc = "内衬", xckb012_desc2 = "透明 15-17g 837826-5 PET0.2mm 高65mm 宽92mm 牧田", xckb037 = "02", xckb037_desc = (null), xckb013 = "PCS", xckb014 = 2000.000000, xckb015 = " ", xckb015_desc = (null), xckb016 = " ", xckb016_desc = (null), xckb017 = " ", xckb102 = 5982.900000, xckb102a = 5982.900000, xckb102b = 0.000000, xckb102c = 0.000000, xckb102d = 0.000000, xckb102e = 0.000000, xckb102f = 0.000000, xckb102g = 0.000000, xckb102h = 0.000000, xckb101 = 2.991450, xckb101a = 2.991450, xckb101b = 0.000000, xckb101c = 0.000000, xckb101d = 0.000000, xckb101e = 0.000000, xckb101f = 0.000000, xckb101g = 0.000000, xckb101h = 0.000000, xckbua123 = "USD", xckbua124 = 6.8956000000, xckbua125 = 0.594700, xckbua126 = 8201.630000, xckbua127 = 0.000000, xckbua128 = 8201.630000}
```


detail2

```sql
SELECT xcbb010,oocql004,xckc004,imaal003,imaal004,xckc023,'',xckc006,xckc003,pmaal004,  xckc005,'',      SUM(xckc007),SUM(xckc008),       SUM(xckcua001),SUM(xckcua101),SUM(xckcua011),SUM(xckcua111),       SUM(xckc008a),SUM(xckc008b),SUM(xckc008c),SUM(xckc008d),                                 SUM(xckc008e),SUM(xckc008f),SUM(xckc008g),SUM(xckc008h),       SUM(xckc009),SUM(xckc010),       SUM(xckcua002),SUM(xckcua102),SUM(xckcua012),SUM(xckcua112),       SUM(xckc010a),SUM(xckc010b),SUM(xckc010c),SUM(xckc010d),                                 SUM(xckc010e),SUM(xckc010f),SUM(xckc010g),SUM(xckc010h),       SUM(xckc011),SUM(xckc012),       SUM(xckcua003),SUM(xckcua103),SUM(xckcua013),SUM(xckcua113),       SUM(xckc012a),SUM(xckc012b),SUM(xckc012c),SUM(xckc012d),                                 SUM(xckc012e),SUM(xckc012f),SUM(xckc012g),SUM(xckc012h),       SUM(xckc013),SUM(xckc014),       nvl(SUM(xckcua004),0),SUM(xckcua104),SUM(xckcua014),SUM(xckcua114),       SUM(xckc014a),SUM(xckc014b),SUM(xckc014c),SUM(xckc014d),                                 SUM(xckc014e),SUM(xckc014f),SUM(xckc014g),SUM(xckc014h),          nvl(SUM(xckcua005),0),  (case when sum(xckcua104)=0 then 0 when abs(round(nvl((SUM(xckcua005) / SUM(xckcua104) * 100), 0),2))>1000 then 0 else round(nvl((SUM(xckcua005) / SUM(xckcua104) * 100), 0),2) end ),sum(xckc013-xckc007),sum(xckc014-xckc008),sum(xckcua104-xckcua101),                    SUM(xckc015),SUM(xckc015a),SUM(xckc015b),SUM(xckc015c),SUM(xckc015d),                                 SUM(xckc015e),SUM(xckc015f),SUM(xckc015g),SUM(xckc015h),                    SUM(xckc016),SUM(xckc016a),SUM(xckc016b),SUM(xckc016c),SUM(xckc016d),                                 SUM(xckc016e),SUM(xckc016f),SUM(xckc016g),SUM(xckc016h),                    SUM(xckc017),SUM(xckc017a),SUM(xckc017b),SUM(xckc017c),SUM(xckc017d),                                 SUM(xckc017e),SUM(xckc017f),SUM(xckc017g),SUM(xckc017h),                    SUM(xckc018),SUM(xckc018a),SUM(xckc018b),SUM(xckc018c),SUM(xckc018d),                                 SUM(xckc018e),SUM(xckc018f),SUM(xckc018g),SUM(xckc018h),                    SUM(xckc019),SUM(xckc019a),SUM(xckc019b),SUM(xckc019c),SUM(xckc019d),                                 SUM(xckc019e),SUM(xckc019f),SUM(xckc019g),SUM(xckc019h),                    SUM(xckc020),SUM(xckc020a),SUM(xckc020b),SUM(xckc020c),SUM(xckc020d),                                 SUM(xckc020e),SUM(xckc020f),SUM(xckc020g),SUM(xckc020h),                    SUM(xckc021),SUM(xckc021a),SUM(xckc021b),SUM(xckc021c),SUM(xckc021d),                                 SUM(xckc021e),SUM(xckc021f),SUM(xckc021g),SUM(xckc021h),                    SUM(xckc022),SUM(xckc022a),SUM(xckc022b),SUM(xckc022c),SUM(xckc022d),                                 SUM(xckc022e),SUM(xckc022f),SUM(xckc022g),SUM(xckc022h)    
FROM xckc_t LEFT JOIN imaal_t ON imaalent='88' AND imaal001=xckc004 AND imaal002='zh_CN'               LEFT JOIN pmaal_t ON pmaalent='88' AND pmaal001=xckc003 AND pmaal002='zh_CN'               LEFT JOIN xcbb_t ON xcbbent = xckcent AND xcbbcomp= xckccomp AND xcbb001 = xckc001 AND xcbb002 = xckc002 AND xcbb003 = xckc004 AND xcbb004 = xckc023                                LEFT JOIN oocql_t ON oocqlent='88' AND oocql001='206' AND oocql002=xcbb010 AND oocql003='zh_CN'  
WHERE xckcent =     88   AND xckccomp='LH01'    AND xckcld  ='00'    AND xckc001 =   2017   AND xckc002 =      6   AND xckccomp='LH01' and xckcld='00' and xckc001=2017 and xckc002=6 GROUP BY xcbb010,oocql004,xckc004,imaal003,imaal004,xckc023,xckc006,xckc003,pmaal004,xckc005  ORDER BY xcbb010,oocql004,xckc004,imaal003,imaal004,xckc023,xckc006,xckc003,pmaal004 

```

3297
3464

## **