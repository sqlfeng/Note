 INSERT INTO 
 axcq761_tmp     SELECT x.*,ROW_NUMBER() OVER 
 (PARTITION BY tlf905,tlf906 ORDER BY tlf01,tlf905,tlf906)    
 FROM 
 (SELECT tlf905,tlf906,tlf01,ima02,ima021,tlf19,occ02,NVL(SUM(tlf10*tlf60*tlf907),0),NVL(SUM(tlfc21*tlf907),0),        0 wsaleamt,0 l_wsale_tlf21,0 l_rate,1 salerat,1 raterat,occ04,'' gen02,'' gem01,'' gem02,        '' oma08,'' oab01,occ03,'' warea_name,ima131,tlf036,NVL(occ37,'N'),       NVL(SUM(tlfc221*tlf907),0),NVL(SUM(tlfc222*tlf907),0),NVL(SUM(tlfc2231*tlf907),0),NVL(SUM(tlfc2232*tlf907),0),       NVL(SUM(tlfc224*tlf907),0),NVL(SUM(tlfc2241*tlf907),0),NVL(SUM(tlfc2242*tlf907),0),NVL(SUM(tlfc2243*tlf907),0),tlf13,NVL(tlf66,'Y'),NVL(azf08,'N'),' ' ogb01,0 ogb03        ,tlf907,oma00  FROM dsstore.ima_file,dsstore.tlf_file  LEFT OUTER JOIN dsstore.occ_file ON tlf19=occ01   LEFT OUTER JOIN dsstore.omb_file ON tlf905 = omb31 AND tlf906 = omb32   LEFT OUTER JOIN dsstore.oma_file ON oma01 = omb01   LEFT OUTER JOIN dsstore.azf_file ON tlf14=azf01 AND azf02='2'   LEFT OUTER JOIN dsstore.tlfc_file ON tlfc01 = tlf01    AND tlfc06 = tlf06  AND tlfc02 = tlf02  AND tlfc03 = tlf03 AND   tlfc13 = tlf13  AND tlfc902= tlf902 AND tlfc903= tlf903 AND   tlfc904= tlf904 AND tlfc907= tlf907 AND   tlfc905= tlf905 AND tlfc906= tlf906 AND   tlfctype = '1'  ,dsstore.smy_file WHERE ima01 = tlf01   AND (tlf13 LIKE 'axmt%' OR tlf13 LIKE 'aomt%')   AND omavoid <> 'Y'    AND  1=1   AND  1=1   AND tlf902 not in (SELECT jce02 from dsstore.jce_file)   AND (tlf06 BETWEEN '17/01/01' AND '17/01/31')   AND tlf905 LIKE TRIM(smyslip)||'-%' AND smydmy1 ='Y'  GROUP BY tlf01,ima02,ima021,ima131,occ02,occ03,occ04,NVL(occ37,'N'),tlf036,tlf13,tlf19,NVL(tlf66,'Y'),tlf905,tlf906,NVL(azf08,'N'),tlf907,oma00    ORDER BY tlf01,tlf905,tlf906) x "

